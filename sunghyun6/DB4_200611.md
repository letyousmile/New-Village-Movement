# DB

##### NOSQL

- 정의
  - 관계형 데이터 모델을 지양 하며, 대량의 분산된 데이터를 저장하고 조회하는 데 특화되었으며 스키마 없이 사용 가능한 느슨한 스키마를 제공하는 저장소를 말한다.
  - 종류마다 쓰기/읽기 성능 특화, 2차 인덱스 지원, 오토 샤딩 지원 같은 고유한 특징을 가진다. 대량의 데이터를 빠르게 처리하기 위해 메모리에 임시 저장하고 응답하는 등의 방법을 사용한다.
- CAP 이론
  - 일관성(Consistency)
    - 다중 클라이언트에서 같은 시간에 조회하는 데이터는 항상 동일한 데이터임을 보증
    - 이것은 관계형 데이터베이스가 지원하는 가장 기본적인 기능이지만, NOSQL은 기본적으로 느슨하게 데이터를 처리하여 데이터가 달라질 수도 있음
    - 각 NOSQL 들은 분산 노드 간의 데이터 동기화를 위해서 두가지 방법을 사용
      - 첫번째는 데이터의 저장 결과를 클라이언트에 응답하기 전에 저장하는 동기식 방법
        - 느리지만 데이터의 정합성 보장
      - 두번쨰는 메모리나 임시 파일에 기록하고 클라이언트에 먼저 응답 후, 이벤트나 프로세스로 노드를 데이터 동기화 함. 빠르지만 장애발생시 데이터 손실 가능성
  - 가용성(Availability)
    - 가용성이란 모든 클라이언트의 읽기와 쓰기 요청에 대하여 항상 응답이 가능함을 보증
    - 몇개의 노드가 망가지더라도 정상적인 서비스 가능
    - 몇몇 NoSQL은 가용성보장을 위해 데이터 복제를 사용한다
  - 네트워크 분할 허용성(Partition tolerance)
    - 지역적으로 분할된 네트워크에서 동작하는 시스템에서 두 지역 간의 네트워크가 단절되거나 네트워크 데이터의 유실이 일어나더라도 정상적으로 동작해야함
- 저장방식에 따른 분류
  - Key-Value Model, Document Model, Column Model, Graph Model
    - Key-Value Model
      - 가장 기본적인 형태의 NoSQL 이며 키 하나로 데이터를 저장하고 조회할 수 있는 단일-키 값 구조를 갖음
      - 단순해서 빠름
      - 근데 한번의 서비스 요청에 다수의 데이터 조회 및 수정이 발생하면 트랜잭션 처리가 불가능하고 정합성을 보장할 수 없음(REDIS)
    - Document Model
      - 키-값 모델을 확장했음
      - 하나의 키에 하나의 구조화된 문서를 저장하고 조회함
      - O(1) 시간 안에 문서를 조회할 수 있음
      - B트리 사용해서 2차 인덱스를 생성함
      - 중앙 집중식 로그, 타임라인 저장, 통계 정보 저장에 사용됨(MongoDB)
    - Column Model
      - 하나의 키에 여러 개의 칼럼 이름과 컬럼 값의 쌍으로 이루어진 데이터 저장/조회
      - 구글의 빅 테이블이 대표적인 예
      - 쓰기에 더 특화되있고
      - 실시간 분석을 위한 데이터 저장소 등의 서비스 구현에 적합