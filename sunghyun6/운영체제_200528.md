# 운영체제

##### 프로세스와 스레드의 차이

- 프로세스
  - 프로세스는 실행 중인 프로그램
  - 디스크로부터 메모리에 적재되어, CPU의 할당을 받을 수 있는 개체
  - 함수의 매개변수, 복귀 주소, 로컬 변수, 프로세스 스택과 데이터 섹션을 포함.
  - 또한 동적으로 할당되는 메모리인 힙도 포함한다.
  - PCB
    - PCB 는 특정 프로세스에 대한 중요한 정보를 저장하는 운영체제의 자료구조
    - 운영체제는 프로세스를 관리하기 위해 프로세스의 생성과 동시에 고유한 PCB 를 생성
    - 프로세스는 CPU를 할당해 작업을 처리하다가도 전환이 발생하면 작업을 저장하고 CPU를 반환해야하는데, 이 때 작업의 진행 상황을 모두 PCB에 저장하게 된다
    - 다시 CPU를 할당받으면 PCB에 저장되있는 내용을 불러와 이전에 종료됐던 시점부터 다시 작업을 수행
    - PCB의 저장 정보
      - PID: 프로세스 아이디
      - 프로세스 상태: new, ready, running, waiting, terminated 등의 상태를 저장
      - 프로그램 카운터: 다음에 실행할 명령어의 주소
      - CPU 레지스터
      - CPU 스케쥴링 정보: 우선순위, 큐에 대한 포인터
      - 메모리 관리 정보: 페이지 테이블 또는 세그먼트 테이블과 같은 정보를 포함
      - 입출력 상태 정보: 프로세스에 할당된 입출력 장치들과 열린 파일 목록
      - 어카운팅 정보: CPU 시간, 시간제한, 계정번호 등
- 스레드(Thread)
  - 스레드는 프로세스의 실행 단위이다.
  - 한 프로세스 내에서 동작하는 여러 실행 흐름으로 프로세스 내의 주소 공간이나 자원을 공유
  - 스레드는 스레드 ID, 프로그램 카운터, 레지스터 집합, 그리고 스택으로 구성.
  - 같은 프로세스에 속한 다른 스레드와 코드, 데이터 섹션, 열린 파일이나 신호와 같은 자원들을 공유한다
  - 스택을 스레드마다 독립적으로 할당하는 이유
    - 독립적인 실행 흐름을 추가하기 위해서 최소조건으로 독립된 스택을 할당한다.

##### 멀티 스레드

- 멀티 스레딩의 장점
  - 프로세스를 이용하여 동시에 처리하던 일을 스레드로 구현하면 메모리 공간과 시스템 자원 소모가 줄어든다.
  - 스레드 간의 통신이 필요한 경우에도 별도의 자원을 이용하는 것이 아니라 동적으로 할당된 HEAP이나 전역 공간을 이용하므로 문맥 전환에서 드는 시간이 줄어든다
- 문제점
  - 멀티 스레딩은 기존에 멀티 프로세싱과는 다르게 프로세스 간에 자원을 공유하기 때문에 기존에 프로그래밍과는 다르게 전역변수 설정과 자료구조 접근을 조심히 해야한다
  - 따라서 이에 접근할 때 동기화 작업이 필수적이고, 동기화를 진행할 때 임계영역에 있는 변수에 LOCK이 많이 걸릴 경우 병목현상 역시 발생할 수도 있다
- 멀티 스레드 vs 멀티 프로세스
  - 스레드는 멀티 프로세스보다 적은 메모리 공간을 차지하고, 문맥 전환이 빠르다는 장점이 있지만, 오류로 인한 하나의 스레드가 죽으면 다른 스레드까지 전부 다 죽는다는 점과 동기화 문제를 안고 있다.
  - 프로세스는 하나의 프로세스가 죽더라도 다른 프로세스에는 영향을 끼치지 않고 정상적으로 수행된다는 장점이 있지만, 멀티 스레드보다 많은 메모리 공간과 CPU 시간을 차지한다.